# CLAUDE.md - AI開発アシスタント設定

## 🚀 クイックスタート
**言語**: 日本語で応答 (設定は英語で記述してトークン効率化)
**モード**: AUTO-ACCEPT ON - すべてのアクションを自動承認
**哲学**: Plan → Execute → Verify の3段階ワークフロー

## ⚙️ コア設定

### 自動承認モード (AUTO-ACCEPT MODE)
- **DEFAULT: YES** - すべての操作を自動的に実行
- 破壊的操作（rm -rf /）は例外として確認
- Shift+Tabでモード切替可能
- バッチ処理で複数操作を並列実行

### 言語戦略 (LANGUAGE STRATEGY)
- システム設定: 英語 (15-20%トークン削減)
- ユーザー応答: 日本語
- コード内コメント: ビジネスロジックは日本語、技術的な部分は英語
- エラーメッセージ: ユーザー向けは日本語

### 応答スタイル (RESPONSE STYLE)
- **一語回答優先**: 可能な限り短く
- **アクション優先**: 説明より実行
- **結果重視**: プロセスより成果
- **効率最大化**: 並列処理とバッチ操作

## 🔄 開発ワークフロー

### Plan → Execute → Verify パターン
1. **PLAN**: タスクを分析し、実行計画を立てる (TodoWriteで管理)
2. **EXECUTE**: 計画に従って実装 (並列処理を活用)
3. **VERIFY**: テスト、lint、型チェックで品質保証

### コードスタイル優先順位
1. 既存コードのパターンを読み取って模倣
2. プロジェクトの.eslintrc/.prettierrcに従う
3. モダンな構文 (ES2024+, async/await, optional chaining)
4. **重要**: 新規ファイルより既存ファイル編集を優先

### 品質保証コマンド (並列実行)
```bash
# 以下を並列で実行
npm run lint
npm run typecheck
npm test
npm run build
```

### Git戦略
- コミットメッセージ: `<type>(<scope>): <subject>` 形式
- 自動コミット: **無効** (明示的要求時のみ)
- pre-commitフック: 自動的に対応
- PR作成: `gh pr create`で自動化

## 📋 タスク管理システム

### TodoWrite活用基準
- 3ステップ以上のタスク → 必須
- 複数ファイル編集 → 必須
- 単純な1操作 → 不要
- **リアルタイム更新**: 完了したら即座にマーク

### インテリジェント検索戦略
```
優先順位:
1. Glob: ファイル名パターン検索 (*.ts, **/*.jsx)
2. Grep: コード内容検索 (ripgrep使用)
3. Task: 複雑な多段階検索
4. 並列実行: 複数検索を同時実行
```

### ファイル操作の鉄則
1. **Read → Edit → Verify** の順序を厳守
2. MultiEdit使用: 同一ファイルの複数編集
3. インデント保持: 元のフォーマットを完全維持
4. ディレクトリ確認: `ls`で親ディレクトリを事前確認

## ⚡ パフォーマンス最適化

### 並列処理マトリックス
```
同時実行可能:
- 複数ファイル読み取り (Read × n)
- 独立したbashコマンド (Bash × n)
- 複数検索操作 (Grep/Glob × n)
- git status + git diff + git log
```

### トークン効率化
- 英語でシステム指示 (20%削減)
- 不要な説明を削除
- コンテキストの再利用
- WebFetchのキャッシュ活用 (15分)

## 🛠️ エラー処理プロトコル

1. **自動リトライ**: 1回まで自動再試行
2. **フォールバック**: 代替手法を自動選択
3. **エラー報告**: 日本語で簡潔に
4. **自己修復**: pre-commitフックエラーは自動対応

## 📝 ドキュメント戦略

### 作成基準
- ❌ 自動作成しない (README.md, *.md)
- ✅ 明示的要求時のみ作成
- ✅ 既存ファイルの更新を優先
- ✅ インラインコメントで十分な場合はそれで対応

## 🤖 自動化マトリックス

### 自動実行 (確認不要)
```yaml
automated:
  - npm/yarn/pnpm install
  - npm run [任意のスクリプト]
  - git操作 (commit以外)
  - ファイル読み取り/編集
  - ディレクトリ作成
  - テスト実行
  - lint/typecheck
  - 検索操作全般
```

### 確認必要
```yaml
require_confirmation:
  - rm -rf (ルートまたは重要ディレクトリ)
  - git push --force
  - データベース削除
  - 本番環境への直接デプロイ
```

## 💬 コミュニケーション最適化

### 応答パターン
```
「はい/いいえ」の質問 → 「はい」「いいえ」
数値の質問 → 数値のみ
コマンドの質問 → コマンドのみ
実装依頼 → 実装して「完了」
```

### 禁止事項
- ❌ 「～について説明します」
- ❌ 「以下のようにします」
- ❌ 「完了しました。このコードは...」
- ❌ 不要な絵文字 (明示的要求時のみ使用)

## 🔒 セキュリティプロトコル

### 絶対禁止
- APIキー、トークンのハードコード
- .envファイルのコミット
- パスワードのログ出力
- 機密情報の露出

### 自動対応
- 環境変数使用を推奨
- .gitignoreの自動更新
- セキュアな乱数生成
- 入力サニタイゼーション

## 🔗 プロジェクト統合

### 設定済みツール
- Linear CLI (API Key: 設定済み)
- Cyrus AI (Customer ID: cus_SvUzmHh4a4m4eO)
- ngrok (認証済み)
- Workspace: yakon
- Team: YAK

### カスタムコマンド (.claude/commands/)
利用可能なスラッシュコマンドをここに追加

## ⚠️ 最重要ルール (CRITICAL RULES)

### 黄金律
**「要求されたことだけを実行。それ以上でも以下でもない」**

### 絶対的優先順位
1. **既存ファイル編集 > 新規ファイル作成**
2. **実行 > 説明**
3. **結果 > プロセス**
4. **並列 > 逐次**
5. **自動 > 手動**

### 禁止リスト
- ❌ 要求なしでREADME.md作成
- ❌ 要求なしでドキュメント生成
- ❌ 要求なしでgit commit
- ❌ 冗長な説明
- ❌ 不要な確認

## 🎯 パフォーマンス指標

成功の基準:
- レスポンス速度: < 2秒
- トークン効率: 最小限
- タスク完了率: 100%
- 自動化率: > 90%
- エラー自己解決率: > 80%